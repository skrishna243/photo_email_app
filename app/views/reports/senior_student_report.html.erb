<div class="d-grid gap-2 d-md-flex justify-content-md-end">
  <%= link_to 'BACK TO SCHOOLS',senior_schools_path, class: 'btn btn-secondary'  %>
</div><br>

<div class="card">
    <div class="card-header header-style"><h3>SENIOR SCHOOLS</h3></div>
    <div class="card-body">
   		<div class="table-responsive">
			<table class="table table-bordered text-center" id = "senior_schools_table">
			<thead>
				<th>School Name</th>
				<th>Added At</th>
				<th>Actions</th>
			</thead>
			<tbody>
				<% @senior_school_students.each do |sch| %>
					<tr>
						<td><%= sch.school_name %></td>
						<td><%= time_formatted(sch.created_at)%></td>
						<td> <%= link_to 'View', senior_school_senior_student_checks_path(sch.school_id),  class: 'btn btn-success'  %>
						</td>
					</tr>
				<% end %>
			</tbody>
			</table>
		</div>
	</div>
</div>
<br><br>

<div class="card">
	<div class="card-header header-style">
			<h4>SENIOR SCHOOL SEARCH</h4>
		</div>
	<div class = "card-body">
			<%= form_tag(senior_student_report_reports_path, method: "get") do  %>

				<div class="row justify-content-center">
			        <div class="col-md-6">
			          <div class="row">
			            <div class="col-sm-3">
			                <%= label_tag 'Event Date' %>
			            </div>
			            <div class="col-md-9">
			            	<%= date_select :event_date, :date_from1, class: "form-control", required: true %>
			            </div>
			          </div>
			        </div> 
			        <div class="col-md-6">
				      	<div class="row">
				      		<div class="col-sm-3">
				        		<%= label_tag 'event_name', 'School Name' %>
				         	</div>
					         <div class="col-md-9">
					        	<%= select_tag :school_name, options_for_select(@senior_schools.map { |value| [ value.school_name, value.id]}, :selected => nil), { include_blank: '----- Select School ------', class: 'form-control' , :required => true} %>
					         </div>
				       </div>
				    </div>
		        </div>
				<br>
					
			      <%= hidden_field_tag 'report_type',  '206'%>

		    	<div class="d-grid gap-2 mx-auto">
		          <%= submit_tag "Submit", type: "submit",class:"btn mx-auto d-block", :style=>  'background-color: #7fbde3; color: white;' %>
		      </div>

			<% end %>
	</div>
</div><br><br><br>

<% unless @senior_student_school.nil? || @senior_student_school.empty? %>
<div class="card">
	<div class="card-header header-style">
		<h4>CHECK IN/OUT STUDENT DATA</h4>
	</div>
  
	<div class = "card-body">
		<div><h3 class="tool_bar"></h3></div>
		<div class="table-responsive">
			<table id="student_table" class="table table-bordered">
				<thead>
					<tr>
						<th>Student Name</th>
						<th>Email</th>
						<th>New Data Entry</th>
						<th>Session</th>
						<th>Check In Time</th>
						<th>Check Out Time</th>
					</tr>
				</thead>
				<tbody>
					<% @senior_student_school.each do |stu| %>
						<tr>
							<td><%= stu_check_name(stu.full_name) %></td>
							<td><%= stu.email%></td>
							<td><%= new_data_entry(stu.new_data).html_safe%></td>
							<td><%= session_type(stu.session_type)  %></td>
							<td><%= datetime_formatted(stu.created_at)%></td>
							<td><%= datetime_formatted(stu.updated_at)%></td>
						</tr>
					<% end %>
				</tbody>
			</table>
		</div>
	</div>
</div>
	<% end %>


<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.6.5/css/buttons.dataTables.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.min.css">
<script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.5.1.js"> </script> 
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.js"> </script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"> </script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.flash.min.js"> </script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.html5.min.js"> </script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.print.min.js"> </script>
<script type="text/javascript" src="https://cdn.datatables.net/searchpanes/1.2.1/js/dataTables.searchPanes.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/select/1.3.1/js/dataTables.select.min.js"></script>

 <script type="text/javascript">
 	// (function()

	// 	{
	// 	  if( window.localStorage )
	// 	  	// debugger;
	// 	  {
	// 	    if( !localStorage.getItem('firstLoad') )
	// 	    {
	// 	      localStorage['firstLoad'] = true;
	// 	      window.location.reload();
	// 	    }  
	// 	    else
	// 	      localStorage.removeItem('firstLoad');
	// 	  }
	// 	}
	// )();


	
 	$(document).ready(function () {
 		$("#footer").removeClass("footer");
 		$("#senior_schools_table").DataTable({ });
 		
 		var dat_1 =	$("#student_table").DataTable({

					   dom: 'Bfrtip',
					  "initComplete": function () {
										var api = this.api();
										var dx_count = api.column(3).data().filter(function(value, index) { return value.includes('DX') ? true : false; }).length;
										var st_count = api.column(3).data().filter(function(value, index) { return value.includes('ST') ? true : false; }).length;
										var yb_count = api.column(3).data().filter(function(value, index) { return value.includes('YB') ? true : false; }).length;
										var rt_count = api.column(3).data().filter(function(value, index) { return value.includes('RT') ? true : false; }).length;
										var ug_count = api.column(3).data().filter(function(value, index) { return value.includes('UG') ? true : false; }).length;
										var ns_count = api.column(3).data().filter(function(value, index) { return value.includes('NS') ? true : false; }).length;
										var total_res = "Session Totals DX: " + dx_count + ", ST: " + st_count + ", YB: " + yb_count + ", RT: " + rt_count + ", UG: " + ug_count + ", NS: " + ns_count;
											return $('.tool_bar').html( total_res);
									},
					buttons:[
								{
								    	
								    extend: 'excel',
								    text: 'Export',
								    filename: 'Student_check_in_out_data',
								    title: function(){
										    	return $('.tool_bar').text()
										    },
								    
								}
					  		],

			});
 	});
 </script>
