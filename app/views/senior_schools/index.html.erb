<div class="card">
<div class="card-header header-style"><h3>ADD SCHOOL</h3></div>
<div class="card-body">
	<%= button_tag('New School', class: 'btn btn-info btn-sm-block float-right fa fa-plus', id: 'add_school') %>
	 <p>Please use this section to add School Information</p>
</div>
</div>
<br><br><br>

<% unless @senior_schools.nil? || @senior_schools.empty? %>

<div class="card">
  <div class="card-header header-style"><h3>SENIOR SCHOOL DETAILS</h3></div>
  <div class="card-body">
   <div class="table-responsive">
	<table class="table table-bordered text-center" id = "schools_table">
	<thead>
		<th>School  Name</th>
		<!-- <th>Added On</th> -->
		<th>Actions</th>
	</thead>
	<tbody>
		<% @senior_schools.each do |sch| %>
			<tr>
				<td><%= (sch.school_name).upcase %></td>
				<!-- <td><%#= date_formatted(sch.created_at)%></td> -->
				<td> <%= link_to 'View', senior_school_senior_students_path(sch.id),  class: 'btn btn-success'  %> &nbsp;&nbsp;&nbsp;
					<%= link_to 'Verify', senior_school_path(sch.id),  class: 'btn btn-info'  %>&nbsp;&nbsp;&nbsp;
					<%# @school_data_present = SeniorStudent.where(school_id: sch.id)%>
					<%# unless @school_data_present.nil? || @school_data_present.empty? %>
						<!-- <button class="btn btn-default" disabled>Blue Print Upload</button> -->
					<%# else %>
						<%#= button_tag('Blue Print Upload'.html_safe,  class: 'btn btn-danger upload-btn', 'data-school-id': sch.id)  %>
					<%# end %>
					<% if sch.senior_students.present?%>
							<button class="btn btn-default" disabled>Blue Print Upload</button>
					<% else %>
							<%= button_tag('Blue Print Upload'.html_safe,  class: 'btn btn-danger upload-btn', 'data-school-id': sch.id)  %>
					<% end %>
				</td>
			</tr>
		<% end %>
	</tbody>
	</table>
</div>
</div>
</div>
<% end %>

	<div class="modal fade" id="school_modal_container" tabindex="-1" role="dialog" aria-hidden="true">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header"><h4 class="modal-title m0">Add School</h4></div>
	      <div class="modal-body"></div>	    
        </div>
	  </div>
	</div>


<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.6.5/css/buttons.dataTables.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.min.css">
<script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.5.1.js"> </script> 
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.js"> </script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"> </script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.flash.min.js"> </script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.html5.min.js"> </script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.print.min.js"> </script>
<script type="text/javascript" src="https://cdn.datatables.net/searchpanes/1.2.1/js/dataTables.searchPanes.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/select/1.3.1/js/dataTables.select.min.js"></script>




<script type="text/javascript">
	(function()

		{
		  if( window.localStorage )
		  	// debugger;
		  {
		    if( !localStorage.getItem('firstLoad') )
		    {
		      localStorage['firstLoad'] = true;
		      window.location.reload();
		    }  
		    else
		      localStorage.removeItem('firstLoad');
		  }
		}
	)();

	function showNewSchoolModal() {
	    $.ajax({
	      url: 'senior_schools/new',
	      success: function(new_school_body) {
	        $('#school_modal_container .modal-body').html(new_school_body);
	        $('.modal').modal('hide');
	        $('#school_modal_container').modal('show');
	        $('#school_modal_container .modal-title').html('New School');
	      }
	    });
	}


  $("#schools_table").DataTable({
		     searching: true,
		});
</script>	
<script type="text/javascript">
  $(document).ready(function(){
    setTimeout(function(){
    $('.flash-panel').fadeOut();
    }, 2000);

    $('#add_school').on('click', function() {
      showNewSchoolModal();
    });


    // $(document).on('click','.btn-edit-school' , function() {
    // 	var school_id = $(this).data('school-id');
    //   $.ajax({
    //     url: 'senior_schools/' + school_id + '/edit',

    //     success: function(edit_school_modal) {
    //       $('#school_modal_container .modal-body').html(edit_school_modal);
    //       $('.modal').modal('hide');
    //       $('#school_modal_container').modal('show');
    //       $('#school_modal_container .modal-title').html('Edit School');
    //     }

    //   });

    // });

    $(document).on('click','.upload-btn' , function() {
    	var school_id = $(this).data('school-id');
      $.ajax({
        url: 'senior_schools/' + school_id + '/upload_senior_student_data',

        success: function(new_upload_student_body) {
          $('#school_modal_container .modal-body').html(new_upload_student_body);
          $('.modal').modal('hide');
          $('#school_modal_container').modal('show');
          $('#school_modal_container .modal-title').html('Upload Student Data');
        }

      });

    });

  })
</script>	